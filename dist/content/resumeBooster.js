(()=>{"use strict";var e={779:(e,t,o)=>{e=o.hmd(e),console.log("HeadHunter Resume Auto-Boost Extension: Content script loaded");const n=['button[data-qa="resume-update-button"]','button[data-qa="resume-boost-button"]','button[data-qa="resume-raise-button"]','button:contains("Поднять в поиске")','button:contains("Поднять резюме")','button:contains("Поднять")','button:contains("Обновить")','a[data-qa="resume-update-button"]','a:contains("Поднять в поиске")','a:contains("Поднять резюме")',".resume-update-button",".boost-button",".resume-raise-button",'[class*="resume"][class*="update"]','[class*="resume"][class*="boost"]','[class*="resume"][class*="raise"]'];let s=!1,r=null,a=null,c=null;function i(){s||(console.log("HeadHunter Resume Auto-Boost: Content script initializing..."),chrome.runtime.onMessage.hasListener(f)&&chrome.runtime.onMessage.removeListener(f),chrome.runtime.onMessage.addListener(f),console.log("Message listener set up"),r&&r.disconnect(),r=new MutationObserver((e=>{let t=!1;for(const o of e){if("childList"===o.type){const e=[...Array.from(o.addedNodes),...Array.from(o.removedNodes)];for(const o of e)if(o.nodeType===Node.ELEMENT_NODE){const e=o;if("BUTTON"===e.tagName||e.querySelector("button")||e.classList.contains("resume-update")||e.classList.contains("boost")){t=!0;break}}}if("attributes"===o.type&&o.target.nodeType===Node.ELEMENT_NODE){const e=o.target;("BUTTON"===e.tagName||e.closest("button")||["disabled","aria-disabled","class"].includes(o.attributeName||""))&&(t=!0)}}t&&setTimeout(g,100)})),r.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["disabled","aria-disabled","class"]}),console.log("Mutation observer set up"),async function(){a&&clearTimeout(a);try{const e=60*((await chrome.storage.sync.get(["extension_settings"])).extension_settings||{refreshInterval:15}).refreshInterval*1e3;a=setTimeout((()=>{m()}),e),console.log(`Page refresh scheduled in ${e/1e3/60} minutes`)}catch(e){console.error("Failed to get refresh interval from settings, using default 15 minutes:",e),a=setTimeout((()=>{m()}),9e5)}}().catch((e=>{console.error("Failed to setup page refresh:",e)})),g(),s=!0,console.log("HeadHunter Resume Auto-Boost: Content script initialized"))}function l(){console.log("Searching for boost button...");for(const e of n)try{if(e.includes(":contains(")){const t=e.match(/contains\("([^"]+)"\)/)?.[1];if(t){const o=e.split(":")[0]||"*",n=document.querySelectorAll(o);console.log(`Checking ${n.length} ${o} elements for text "${t}"`);for(let e=0;e<n.length;e++){const o=n[e];if(o&&o.textContent?.includes(t))return console.log(`Found button with text "${t}":`,o),o}}}else{const t=document.querySelector(e);if(t)return console.log(`Found button with selector "${e}":`,t),t}}catch(t){console.warn(`Failed to query selector ${e}:`,t)}const e=document.querySelectorAll('button, a[role="button"], [class*="button"]');return console.log(`No boost button found. Total buttons/links on page: ${e.length}`),e.length>0&&(console.log("Available buttons/links:"),e.forEach(((e,t)=>{t<10&&console.log(`  ${t+1}. Text: "${e.textContent?.trim()}", Classes: "${e.className}", Data-qa: "${e.getAttribute("data-qa")}"`)}))),null}function u(){const e=l();if(!e)return!1;if(e.hasAttribute("disabled")||"true"===e.getAttribute("aria-disabled"))return!1;const t=e.classList,o=["disabled","inactive","loading","cooldown"];for(const e of o)if(t.contains(e))return!1;const n=e.textContent?.toLowerCase()||"",s=["подождите","обновлено","недоступно","заблокировано"];for(const e of s)if(n.includes(e))return!1;return!0}async function d(){try{const e=l();if(!e)return console.warn("Boost button not found"),!1;if(!u())return console.warn("Boost button is not active/clickable"),!1;e.scrollIntoView({behavior:"smooth",block:"center"}),await new Promise((e=>setTimeout(e,500)));const t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});return e.dispatchEvent(t),"function"==typeof e.click&&e.click(),console.log("Boost button clicked successfully"),await new Promise((e=>setTimeout(e,1e3))),!0}catch(e){return console.error("Failed to click boost button:",e),!1}}function m(){try{console.log("Refreshing page to maintain session..."),window.location.reload()}catch(e){console.error("Failed to refresh page:",e)}}function g(){const e=l(),t=u();c!==t&&(c=t,function(e){try{chrome.runtime.sendMessage(e)}catch(e){console.error("Failed to send message to background:",e)}}({type:"BUTTON_STATE",success:!0,data:{buttonFound:!!e,isActive:t,buttonText:e?.textContent||null}}))}function f(e,t,o){switch(console.log("Content script received message:",e),e.type){case"BOOST_RESUME":return async function(e){try{e({type:"BUTTON_CLICKED",success:await d(),data:{timestamp:Date.now(),buttonFound:!!l(),wasActive:u()}})}catch(t){console.error("Error handling boost request:",t),e({type:"ERROR",success:!1,data:{error:t instanceof Error?t.message:"Unknown error",timestamp:Date.now()}})}}(o),!0;case"CHECK_BUTTON_STATE":return function(e){const t=l();e({type:"BUTTON_STATE",success:!0,data:{buttonFound:!!t,isActive:u(),buttonText:t?.textContent||null,timestamp:Date.now()}})}(o),!1;case"REFRESH_PAGE":return m(),o({type:"PAGE_REFRESHED",success:!0}),!1;case"GET_STATE":return function(e){const t=l();e({type:"BUTTON_STATE",success:!0,data:{isInitialized:s,buttonFound:!!t,isActive:u(),buttonText:t?.textContent||null,url:window.location.href,title:document.title,timestamp:Date.now()}})}(o),!1;case"SETTINGS_UPDATE":return n=e.data,console.log("🔄 Content script received settings update:",n),console.log("🔄 Settings type:",typeof n),console.log("🔄 Settings keys:",Object.keys(n||{})),n&&n.refreshInterval?(console.log(`🔄 Updating page refresh interval to ${n.refreshInterval} minutes`),function(e){console.log(`🔄 Setting up page refresh with interval: ${e} minutes`),a&&(console.log("🔄 Clearing existing refresh timer"),clearTimeout(a));try{const t=60*e*1e3;console.log(`🔄 Calculated refresh interval: ${t}ms`),a=setTimeout((()=>{console.log("🔄 Page refresh timer expired, refreshing page..."),m()}),t),console.log(`✅ Page refresh scheduled in ${e} minutes (${t}ms)`)}catch(e){console.error("❌ Failed to setup page refresh with interval:",e),a=setTimeout((()=>{m()}),9e5),console.log("🔄 Fallback: Page refresh scheduled in 15 minutes")}}(n.refreshInterval)):console.warn("🔄 No refreshInterval found in settings:",n),o({type:"BUTTON_STATE",success:!0}),!1;default:return console.warn("Unknown message type:",e.type),o({type:"ERROR",success:!1,data:"Unknown message type"}),!1}var n}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i(),window.addEventListener("beforeunload",(function(){r&&(r.disconnect(),r=null),a&&(clearTimeout(a),a=null),chrome.runtime.onMessage.hasListener(f)&&chrome.runtime.onMessage.removeListener(f),s=!1,console.log("Content script cleaned up")})),e.exports&&(e.exports={findBoostButton:l,isButtonActive:u,clickBoostButton:d,refreshPage:m,checkButtonState:g})}},t={};function o(n){var s=t[n];if(void 0!==s)return s.exports;var r=t[n]={id:n,loaded:!1,exports:{}};return e[n](r,r.exports,o),r.loaded=!0,r.exports}o.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),o(779)})();